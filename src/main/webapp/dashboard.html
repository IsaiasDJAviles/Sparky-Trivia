<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Sparky Trivia</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">

    <style>
        .dashboard-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
        }
        .dashboard-card {
            max-width: 900px;
            width: 100%;
            animation: fadeInDown 0.6s ease;
        }

        .user-welcome {
            text-align: center;
            margin-bottom: 40px;
        }
        .user-welcome h2 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        .user-info {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 10px 20px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: var(--radius-md);
            margin-top: 10px;
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            margin-bottom: 30px;
        }

        .action-card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: var(--radius-lg);
            border: 2px solid transparent;
            transition: all var(--transition-normal);
            cursor: pointer;
            text-align: center;
        }
        .action-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--sombra-fuerte);
            border-color: rgba(102, 126, 234, 0.3);
        }

        .action-card.blue { background: linear-gradient(135deg, rgba(102, 126, 234, 0.15), rgba(118, 75, 162, 0.15)); }
        .action-card.blue:hover { box-shadow: var(--sombra-azul); }

        .action-card.yellow { background: linear-gradient(135deg, rgba(255, 214, 0, 0.15), rgba(251, 99, 64, 0.15)); }
        .action-card.yellow:hover { box-shadow: 0 8px 30px rgba(255, 214, 0, 0.3); }

        .action-card.red { background: linear-gradient(135deg, rgba(245, 54, 92, 0.15), rgba(251, 99, 64, 0.15)); }
        .action-card.red:hover { box-shadow: var(--sombra-roja); }

        .action-card.green { background: linear-gradient(135deg, rgba(45, 206, 137, 0.15), rgba(17, 205, 239, 0.15)); }
        .action-card.green:hover { box-shadow: var(--sombra-verde); }

        .action-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }
        .action-card.blue .action-icon { color: #667eea; }
        .action-card.yellow .action-icon { color: #ffd600; }
        .action-card.red .action-icon { color: #f5365c; }
        .action-card.green .action-icon { color: #2dce89; }

        .action-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--color-negro);
        }
        .action-description {
            font-size: 0.9rem;
            color: var(--color-gris);
        }

        .logout-section {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid rgba(0,0,0,0.1);
        }

        @media (max-width: 768px) {
            .actions-grid {
                grid-template-columns: 1fr;
            }
            .user-welcome h2 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
<div id="particles-js"></div>

<header class="header">
    <div class="header-content">
        <div class="logo" onclick="window.location.href='dashboard.html'">
            <img src="images/sparky_logo.png" alt="Sparky">
            <h1>Sparky Trivia</h1>
        </div>
    </div>
</header>

<div class="dashboard-container">
    <div class="dashboard-card card card-tilt" data-aos="fade-up">
        <div class="sparky-container" data-aos="zoom-in">
            <img src="images/sparky_feliz.png?v=3" alt="Sparky" id="sparky">
        </div>

        <div class="user-welcome">
            <h2 class="text-gradient">隆Bienvenido, <span id="userNickname"></span>! </h2>
            <p class="text-muted">驴Qu茅 te gustar铆a hacer hoy?</p>
            <div class="user-info">
                <i class="bi bi-person-circle"></i>
                <span id="userEmail"></span>
            </div>
        </div>

        <div class="actions-grid">
            <!-- Crear Sala -->
            <div class="action-card blue" onclick="window.location.href='crear-sala.html'" data-aos="fade-right">
                <i class="bi bi-door-open-fill action-icon"></i>
                <h3 class="action-title">Crear Sala</h3>
                <p class="action-description">Inicia una nueva partida de trivia</p>
            </div>

            <!-- Unirme a Sala -->
            <div class="action-card yellow" onclick="window.location.href='unirse-sala.html'" data-aos="fade-left">
                <i class="bi bi-box-arrow-in-right action-icon"></i>
                <h3 class="action-title">Unirme a Sala</h3>
                <p class="action-description">nete con un c贸digo de sala</p>
            </div>

            <!-- Crear Set de Estudio -->
            <div class="action-card red" onclick="window.location.href='crear-trivia.html'" data-aos="fade-right" data-aos-delay="100">
                <i class="bi bi-pencil-square action-icon"></i>
                <h3 class="action-title">Crear Set de Estudio</h3>
                <p class="action-description">Dise帽a tu propia trivia personalizada</p>
            </div>

            <!-- Mis Trivias -->
            <div class="action-card green" onclick="window.location.href='mis-trivias.html'" data-aos="fade-left" data-aos-delay="100">
                <i class="bi bi-collection-fill action-icon"></i>
                <h3 class="action-title">Mis Trivias</h3>
                <p class="action-description">Administra tus sets de estudio</p>
            </div>
        </div>

        <!-- Secci贸n adicional -->
        <div class="text-center mb-3">
            <button class="btn btn-azul btn-ripple" onclick="window.location.href='explorar-trivias.html'" style="max-width: 400px;">
                <i class="bi bi-search me-2"></i>Explorar Trivias P煤blicas
            </button>
        </div>

        <div class="logout-section">
            <button class="btn btn-rojo btn-ripple" onclick="logout()" style="max-width: 300px;">
                <i class="bi bi-box-arrow-right me-2"></i>Cerrar Sesi贸n
            </button>
        </div>
    </div>
</div>

<footer class="footer">
    <p>&copy; 2025 Sparky Trivia | Renata Castro & Isa铆as Avil茅s</p>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vanilla-tilt@1.8.0/dist/vanilla-tilt.min.js"></script>
<script src="js/animations.js"></script>
<script src="js/auth.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Verificar si hay usuario logueado
        const usuario = obtenerUsuario();

        if (!usuario || !usuario.nickName) {
            // Si no hay usuario, redirigir a login
            window.location.href = 'login.html';
        } else {
            // Mostrar datos del usuario
            document.getElementById('userNickname').textContent = usuario.nickName;
            document.getElementById('userEmail').textContent = usuario.email;
        }
    });

    // Funci贸n para cerrar sesi贸n
    async function logout() {
        try {
            await fetch('/SparkyTrivia/api/auth/logout', {
                method: 'POST'
            });
        } catch (error) {
            console.error('Error al cerrar sesi贸n:', error);
        }

        // Limpiar localStorage
        limpiarSesion();

        // Redirigir a login
        window.location.href = 'login.html';
    }
</script>
</body>
</html>