<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultados - Sparky Trivia</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="css/styles.css">

    <style>
        .resultados-container {
            min-height: 100vh;
            padding: 40px 20px;
        }

        /* PODIO */
        .podio-container {
            max-width: 900px;
            margin: 0 auto 50px;
            padding: 40px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .resultado-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .resultado-titulo {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 10px;
            animation: bounceIn 0.8s ease;
        }

        .resultado-subtitulo {
            font-size: 1.3rem;
            color: #8898aa;
        }

        .podio {
            display: flex;
            align-items: flex-end;
            justify-content: center;
            gap: 20px;
            margin-bottom: 50px;
            min-height: 350px;
        }

        .podio-item {
            flex: 1;
            max-width: 250px;
            text-align: center;
            animation: slideUp 0.6s ease;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .podio-item:hover {
            transform: translateY(-10px);
        }

        .podio-item.segundo { animation-delay: 0.2s; }
        .podio-item.primero { animation-delay: 0.4s; }
        .podio-item.tercero { animation-delay: 0.6s; }

        .podio-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            font-weight: 700;
            color: white;
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .podio-item.primero .podio-avatar {
            width: 150px;
            height: 150px;
            font-size: 4rem;
            background: linear-gradient(135deg, #FFD700, #FFA500);
        }

        .podio-item.segundo .podio-avatar {
            background: linear-gradient(135deg, #C0C0C0, #A8A8A8);
        }

        .podio-item.tercero .podio-avatar {
            background: linear-gradient(135deg, #CD7F32, #B8860B);
        }

        .corona {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2.5rem;
            animation: float 2s ease-in-out infinite;
        }

        .podio-nombre {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: #32325d;
        }

        .podio-stats {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .podio-puntaje {
            font-size: 2rem;
            font-weight: 700;
            color: #5e72e4;
            margin-bottom: 5px;
        }

        .podio-precision {
            font-size: 0.9rem;
            color: #8898aa;
            margin-bottom: 5px;
        }

        /* ‚≠ê NUEVO: Mostrar correctas/total */
        .podio-correctas {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2dce89;
            margin-top: 5px;
        }

        .podio-base {
            background: linear-gradient(135deg, rgba(94, 114, 228, 0.1), rgba(118, 75, 162, 0.1));
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
        }

        .podio-item.primero .podio-base {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 165, 0, 0.1));
            height: 180px;
        }

        .podio-item.segundo .podio-base {
            background: linear-gradient(135deg, rgba(192, 192, 192, 0.2), rgba(168, 168, 168, 0.1));
            height: 140px;
        }

        .podio-item.tercero .podio-base {
            background: linear-gradient(135deg, rgba(205, 127, 50, 0.2), rgba(184, 134, 11, 0.1));
            height: 100px;
        }

        /* RANKING COMPLETO */
        .ranking-completo {
            max-width: 900px;
            margin: 0 auto 50px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .ranking-completo h3 {
            margin-bottom: 25px;
            font-weight: 700;
        }

        .ranking-tabla-item {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            margin-bottom: 15px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .ranking-tabla-item:hover {
            border-color: #5e72e4;
            transform: translateX(10px);
        }

        .ranking-tabla-item.yo {
            border-color: #5e72e4;
            background: rgba(94, 114, 228, 0.05);
        }

        .ranking-tabla-pos {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #5e72e4, #764ba2);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .ranking-tabla-info {
            flex: 1;
        }

        .ranking-tabla-nombre {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .ranking-tabla-stats {
            display: flex;
            gap: 20px;
            font-size: 0.9rem;
            color: #8898aa;
        }

        .ranking-tabla-pts {
            font-weight: 700;
            font-size: 1.5rem;
            color: #5e72e4;
        }

        /* MIS RESPUESTAS */
        .mis-respuestas {
            max-width: 900px;
            margin: 0 auto 50px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .mis-respuestas h3 {
            margin-bottom: 25px;
            font-weight: 700;
        }

        .respuesta-item {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .respuesta-item:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .respuesta-item.correcta {
            border-color: #2dce89;
            background: rgba(45, 206, 137, 0.05);
        }

        .respuesta-item.incorrecta {
            border-color: #f5365c;
            background: rgba(245, 54, 92, 0.05);
        }

        .respuesta-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .respuesta-icono {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .respuesta-item.correcta .respuesta-icono {
            background: linear-gradient(135deg, #2dce89, #11cdef);
            color: white;
        }

        .respuesta-item.incorrecta .respuesta-icono {
            background: linear-gradient(135deg, #f5365c, #f56036);
            color: white;
        }

        .respuesta-pregunta {
            flex: 1;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .respuesta-puntos {
            font-weight: 700;
            font-size: 1.3rem;
        }

        .respuesta-item.correcta .respuesta-puntos {
            color: #2dce89;
        }

        .respuesta-item.incorrecta .respuesta-puntos {
            color: #f5365c;
        }

        .respuesta-detalles {
            padding-left: 65px;
        }

        .respuesta-label {
            font-size: 0.85rem;
            color: #8898aa;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .respuesta-texto {
            padding: 10px 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .respuesta-tuya {
            background: rgba(94, 114, 228, 0.1);
            border-left: 4px solid #5e72e4;
        }

        .respuesta-correcta-texto {
            background: rgba(45, 206, 137, 0.1);
            border-left: 4px solid #2dce89;
        }

        /* BOTONES */
        .botones-accion {
            max-width: 900px;
            margin: 30px auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        /* ANIMACIONES */
        @keyframes bounceIn {
            0% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes float {
            0%, 100% { transform: translate(-50%, 0px); }
            50% { transform: translate(-50%, -10px); }
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            .podio {
                flex-direction: column;
                align-items: center;
                gap: 30px;
            }

            .podio-item {
                max-width: 100%;
            }

            .podio-base {
                height: auto !important;
                min-height: 100px;
            }

            .resultado-titulo {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
<div id="particles-js"></div>

<div class="resultados-container">
    <!-- HEADER -->
    <div class="resultado-header">
        <div class="resultado-titulo" id="resultadoTitulo">üèÜ ¬°Resultados!</div>
        <div class="resultado-subtitulo">As√≠ qued√≥ el ranking final</div>
    </div>

    <!-- PODIO TOP 3 -->
    <div class="podio-container">
        <div class="podio" id="podio">
            <!-- Segundo Lugar -->
            <div class="podio-item segundo" style="display: none;" id="segundo">
                <div class="podio-avatar">
                    <span id="segundo-inicial">A</span>
                </div>
                <div class="podio-nombre" id="segundo-nombre">Jugador 2</div>
                <div class="podio-stats">
                    <div class="podio-puntaje" id="segundo-puntaje">850</div>
                    <div class="podio-correctas" id="segundo-correctas">8/10 correctas</div>
                    <div class="podio-precision" id="segundo-precision">85% precisi√≥n</div>
                </div>
                <div class="podio-base">
                    <div style="font-size: 3rem; font-weight: 700; color: #C0C0C0;">2</div>
                </div>
            </div>

            <!-- Primer Lugar -->
            <div class="podio-item primero" style="display: none;" id="primero">
                <div class="podio-avatar">
                    <div class="corona">üëë</div>
                    <span id="primero-inicial">A</span>
                </div>
                <div class="podio-nombre" id="primero-nombre">Campe√≥n</div>
                <div class="podio-stats">
                    <div class="podio-puntaje" id="primero-puntaje">1000</div>
                    <div class="podio-correctas" id="primero-correctas">10/10 correctas</div>
                    <div class="podio-precision" id="primero-precision">100% precisi√≥n</div>
                </div>
                <div class="podio-base">
                    <div style="font-size: 4rem; font-weight: 700; color: #FFD700;">1</div>
                </div>
            </div>

            <!-- Tercer Lugar -->
            <div class="podio-item tercero" style="display: none;" id="tercero">
                <div class="podio-avatar">
                    <span id="tercero-inicial">A</span>
                </div>
                <div class="podio-nombre" id="tercero-nombre">Jugador 3</div>
                <div class="podio-stats">
                    <div class="podio-puntaje" id="tercero-puntaje">720</div>
                    <div class="podio-correctas" id="tercero-correctas">7/10 correctas</div>
                    <div class="podio-precision" id="tercero-precision">72% precisi√≥n</div>
                </div>
                <div class="podio-base">
                    <div style="font-size: 3rem; font-weight: 700; color: #CD7F32;">3</div>
                </div>
            </div>
        </div>
    </div>

    <!-- RANKING COMPLETO -->
    <div class="ranking-completo">
        <h3><i class="bi bi-list-ol me-2"></i>Ranking Completo</h3>
        <div id="rankingCompleto"></div>
    </div>

    <!-- MIS RESPUESTAS -->
    <div class="mis-respuestas">
        <h3><i class="bi bi-clipboard-check me-2"></i>Mis Respuestas</h3>
        <div id="misRespuestas"></div>
    </div>

    <!-- BOTONES DE ACCI√ìN -->
    <div class="botones-accion">
        <button class="btn btn-azul btn-ripple" onclick="window.location.href='dashboard.html'">
            <i class="bi bi-house-fill me-2"></i>Volver al Dashboard
        </button>
        <button class="btn btn-verde btn-ripple" onclick="compartirResultados()">
            <i class="bi bi-share-fill me-2"></i>Compartir Resultados
        </button>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<script src="js/animations.js"></script>
<script src="js/auth.js"></script>

<script>
    let codigoSala = null;
    let usuario = null;
    let rankingFinal = [];
    let miPosicion = 0;
    let totalPreguntas = 0;

    document.addEventListener('DOMContentLoaded', async function() {
        protegerPagina('login.html');
        usuario = obtenerUsuario();

        const params = new URLSearchParams(window.location.search);
        codigoSala = params.get('codigo');

        if (!codigoSala) {
            alert('C√≥digo de sala no especificado');
            window.location.href = 'dashboard.html';
            return;
        }

        // Inicializar particles
        if (typeof particlesJS !== 'undefined') {
            particlesJS('particles-js', {
                particles: {
                    number: { value: 80 },
                    color: { value: '#ffffff' },
                    opacity: { value: 0.3 },
                    size: { value: 3 },
                    move: { enable: true, speed: 2 }
                }
            });
        }

        // Cargar datos
        await cargarResultados();
    });

    async function cargarResultados() {
        try {
            console.log('üìä Cargando resultados para sala:', codigoSala);

            const response = await fetch(`/SparkyTrivia/api/salas/resultados?codigo=${codigoSala}`, {
                method: 'GET',
                credentials: 'include'
            });

            const data = await response.json();
            console.log('Respuesta del servidor:', data);

            if (!data.success || !data.ranking || data.ranking.length === 0) {
                const rankingGuardado = localStorage.getItem('rankingFinal_' + codigoSala);
                if (rankingGuardado) {
                    rankingFinal = JSON.parse(rankingGuardado);
                    console.log('‚úÖ Ranking cargado desde localStorage');
                } else {
                    throw new Error('No se encontraron resultados');
                }
            } else {
                rankingFinal = data.ranking;
                console.log('‚úÖ Ranking cargado desde servidor');
            }

            // Encontrar mi posici√≥n y calcular total de preguntas
            const miResultado = rankingFinal.find(r => r.nickname === usuario.nickName);
            if (miResultado) {
                miPosicion = miResultado.rangoFinal;
                totalPreguntas = miResultado.respondidas; // Total de preguntas respondidas
                console.log('üèÜ Mi posici√≥n:', miPosicion, '| Total preguntas:', totalPreguntas);
            }

            // Mostrar resultados
            mostrarPodio();
            mostrarRankingCompleto();
            await cargarMisRespuestas();

            // Efecto de confetti si ganaste
            if (miPosicion === 1 && typeof confetti !== 'undefined') {
                confetti({
                    particleCount: 200,
                    spread: 100,
                    origin: { y: 0.4 }
                });
                document.getElementById('resultadoTitulo').textContent = 'üèÜ ¬°GANASTE!';
            } else if (miPosicion <= 3 && miPosicion > 0) {
                document.getElementById('resultadoTitulo').textContent = 'üéâ ¬°Top 3!';
            } else if (miPosicion > 3) {
                document.getElementById('resultadoTitulo').textContent = 'üìä Resultados';
            }

        } catch (error) {
            console.error('‚ùå Error cargando resultados:', error);
            document.getElementById('resultadoTitulo').textContent = '‚ùå Error al cargar resultados';

            document.querySelector('.podio-container').innerHTML = `
                <div class="alert alert-danger">
                    <i class="bi bi-exclamation-triangle me-2"></i>
                    Error: ${error.message}.
                    <br><br>
                    <a href="dashboard.html" class="btn btn-primary">
                        <i class="bi bi-house-fill me-2"></i>Volver al Dashboard
                    </a>
                </div>
            `;
        }
    }

    function mostrarPodio() {
        console.log('ü•á Mostrando podio con', rankingFinal.length, 'jugadores');

        if (rankingFinal.length >= 1) {
            const primero = rankingFinal[0];
            const totalPreg = primero.respondidas || totalPreguntas || 10;

            document.getElementById('primero').style.display = 'block';
            document.getElementById('primero-inicial').textContent = primero.nickname.charAt(0).toUpperCase();
            document.getElementById('primero-nombre').textContent = primero.nickname;
            document.getElementById('primero-puntaje').textContent = primero.puntajeFinal || 0;

            // ‚≠ê MOSTRAR CORRECTAS/TOTAL
            document.getElementById('primero-correctas').textContent =
                `${primero.correctas || 0}/${totalPreg} correctas`;

            const precision1 = primero.precision ||
                (primero.respondidas > 0 ? (primero.correctas / primero.respondidas * 100) : 0);
            document.getElementById('primero-precision').textContent = precision1.toFixed(1) + '% precisi√≥n';
        }

        if (rankingFinal.length >= 2) {
            const segundo = rankingFinal[1];
            const totalPreg = segundo.respondidas || totalPreguntas || 10;

            document.getElementById('segundo').style.display = 'block';
            document.getElementById('segundo-inicial').textContent = segundo.nickname.charAt(0).toUpperCase();
            document.getElementById('segundo-nombre').textContent = segundo.nickname;
            document.getElementById('segundo-puntaje').textContent = segundo.puntajeFinal || 0;

            // ‚≠ê MOSTRAR CORRECTAS/TOTAL
            document.getElementById('segundo-correctas').textContent =
                `${segundo.correctas || 0}/${totalPreg} correctas`;

            const precision2 = segundo.precision ||
                (segundo.respondidas > 0 ? (segundo.correctas / segundo.respondidas * 100) : 0);
            document.getElementById('segundo-precision').textContent = precision2.toFixed(1) + '% precisi√≥n';
        }

        if (rankingFinal.length >= 3) {
            const tercero = rankingFinal[2];
            const totalPreg = tercero.respondidas || totalPreguntas || 10;

            document.getElementById('tercero').style.display = 'block';
            document.getElementById('tercero-inicial').textContent = tercero.nickname.charAt(0).toUpperCase();
            document.getElementById('tercero-nombre').textContent = tercero.nickname;
            document.getElementById('tercero-puntaje').textContent = tercero.puntajeFinal || 0;

            // ‚≠ê MOSTRAR CORRECTAS/TOTAL
            document.getElementById('tercero-correctas').textContent =
                `${tercero.correctas || 0}/${totalPreg} correctas`;

            const precision3 = tercero.precision ||
                (tercero.respondidas > 0 ? (tercero.correctas / tercero.respondidas * 100) : 0);
            document.getElementById('tercero-precision').textContent = precision3.toFixed(1) + '% precisi√≥n';
        }
    }

    function mostrarRankingCompleto() {
        console.log('üìã Mostrando ranking completo');
        const container = document.getElementById('rankingCompleto');

        if (!rankingFinal || rankingFinal.length === 0) {
            container.innerHTML = '<p class="text-muted">No hay datos de ranking</p>';
            return;
        }

        container.innerHTML = rankingFinal.map(jugador => {
            const esYo = jugador.nickname === usuario.nickName;
            const precision = jugador.precision ||
                (jugador.respondidas > 0 ? (jugador.correctas / jugador.respondidas * 100) : 0);

            return `
                <div class="ranking-tabla-item ${esYo ? 'yo' : ''}">
                    <div class="ranking-tabla-pos">${jugador.rangoFinal || '?'}</div>
                    <div class="ranking-tabla-info">
                        <div class="ranking-tabla-nombre">
                            ${jugador.nickname}
                            ${esYo ? '<span class="badge bg-primary ms-2">T√ö</span>' : ''}
                        </div>
                        <div class="ranking-tabla-stats">
                            <span><i class="bi bi-check-circle-fill text-success me-1"></i>${jugador.correctas || 0}/${jugador.respondidas || 0} correctas</span>
                            <span><i class="bi bi-percent me-1"></i>${precision.toFixed(1)}% precisi√≥n</span>
                        </div>
                    </div>
                    <div class="ranking-tabla-pts">${jugador.puntajeFinal || 0}</div>
                </div>
            `;
        }).join('');
    }

    async function cargarMisRespuestas() {
        console.log('üìù Cargando mis respuestas...');

        try {
            const response = await fetch(`/SparkyTrivia/api/salas/mis-respuestas?codigo=${codigoSala}`, {
                method: 'GET',
                credentials: 'include'
            });

            const data = await response.json();
            console.log('Respuesta del servidor (mis-respuestas):', data);

            if (data.success && data.respuestas && data.respuestas.length > 0) {
                mostrarMisRespuestas(data.respuestas);
                console.log('‚úÖ Respuestas cargadas:', data.respuestas.length);
            } else {
                document.getElementById('misRespuestas').innerHTML = `
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle me-2"></i>
                        No se encontraron tus respuestas registradas.
                        ${data.message ? '<br><small>' + data.message + '</small>' : ''}
                    </div>
                `;
            }

        } catch (error) {
            console.error('‚ùå Error cargando respuestas:', error);
            document.getElementById('misRespuestas').innerHTML = `
                <div class="alert alert-warning">
                    <i class="bi bi-exclamation-triangle me-2"></i>
                    No se pudieron cargar las respuestas: ${error.message}
                </div>
            `;
        }
    }

    function mostrarMisRespuestas(respuestas) {
        const container = document.getElementById('misRespuestas');

        if (!respuestas || respuestas.length === 0) {
            container.innerHTML = `
                <div class="alert alert-info">
                    <i class="bi bi-info-circle me-2"></i>
                    No hay respuestas para mostrar
                </div>
            `;
            return;
        }

        container.innerHTML = respuestas.map((respuesta, index) => {
            const esCorrecta = respuesta.esCorrecta;

            return `
                <div class="respuesta-item ${esCorrecta ? 'correcta' : 'incorrecta'}">
                    <div class="respuesta-header">
                        <div class="respuesta-icono">
                            ${esCorrecta ? '‚úì' : '‚úó'}
                        </div>
                        <div class="respuesta-pregunta">
                            Pregunta ${index + 1}: ${respuesta.pregunta}
                        </div>
                        <div class="respuesta-puntos">
                            ${esCorrecta ? '+' : ''}${respuesta.puntosGanados || 0} pts
                        </div>
                    </div>
                    <div class="respuesta-detalles">
                        <div class="respuesta-label">Tu respuesta:</div>
                        <div class="respuesta-texto respuesta-tuya">
                            ${respuesta.tuRespuesta || 'No respondida'}
                        </div>
                        ${!esCorrecta ? `
                            <div class="respuesta-label">Respuesta correcta:</div>
                            <div class="respuesta-texto respuesta-correcta-texto">
                                ${respuesta.respuestaCorrecta}
                            </div>
                        ` : ''}
                        <div class="text-muted" style="font-size: 0.85rem;">
                            <i class="bi bi-clock me-1"></i>Respondiste en ${respuesta.tiempoTomado || 0}s
                        </div>
                    </div>
                </div>
            `;
        }).join('');
    }

    function compartirResultados() {
        const miResultado = rankingFinal.find(r => r.nickname === usuario.nickName);
        const correctas = miResultado ? miResultado.correctas : 0;
        const total = miResultado ? miResultado.respondidas : 0;
        const puntaje = miResultado ? miResultado.puntajeFinal : 0;

        const texto = `üèÜ ¬°Termin√© la trivia en Sparky Trivia!

üìä Posici√≥n: #${miPosicion}
‚úÖ Correctas: ${correctas}/${total}
‚≠ê Puntaje: ${puntaje} pts
üéÆ C√≥digo de sala: ${codigoSala}

¬°√önete y compite conmigo!`;

        if (navigator.share) {
            navigator.share({
                title: 'Sparky Trivia - Mis Resultados',
                text: texto
            }).catch(console.error);
        } else {
            navigator.clipboard.writeText(texto).then(() => {
                alert('¬°Resultados copiados al portapapeles!');
            }).catch(err => {
                console.error('Error al copiar:', err);
                alert('No se pudo copiar al portapapeles');
            });
        }
    }
</script>
</body>
</html>